{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 34, "column": 0}, "map": {"version":3,"sources":["file:///home/yannis/Spotify_Agent/spotify-agent-frontend/src/components/Sidebar.tsx"],"sourcesContent":["'use client';\n\nimport { useEffect, useState } from 'react';\nimport { Plus, MessageCircle, Trash2 } from 'lucide-react';\nimport Link from 'next/link';\nimport { useRouter } from 'next/navigation';\n\ninterface ConversationSummary {\n  session_id: string;\n  first_message: string;\n  message_count: number;\n  last_message_time: string;\n}\n\ninterface SidebarProps {\n  currentSessionId: string | null;\n  onNewChat: () => void;\n}\n\nexport default function Sidebar({ currentSessionId, onNewChat }: SidebarProps) {\n  const [conversations, setConversations] = useState<ConversationSummary[]>([]);\n  const [loading, setLoading] = useState(true);\n  const [error, setError] = useState<string | null>(null);\n  const router = useRouter();\n\n  useEffect(() => {\n    fetchAllConversations();\n    const interval = setInterval(fetchAllConversations, 30000);\n    return () => clearInterval(interval);\n  }, []);\n\n  const fetchAllConversations = async () => {\n    try {\n      setError(null);\n      const response = await fetch('http://localhost:5000/chat/all-conversations', {\n        method: 'GET',\n        headers: {\n          'Content-Type': 'application/json',\n        },\n      });\n\n      if (!response.ok) {\n        throw new Error(`HTTP error! status: ${response.status}`);\n      }\n\n      const data = await response.json();\n\n      if (Array.isArray(data)) {\n        setConversations(data);\n      } else {\n        setConversations([]);\n      }\n      setLoading(false);\n    } catch (error) {\n      console.error('Failed to fetch conversations:', error);\n      setError('Failed to load conversation history');\n      setLoading(false);\n    }\n  };\n\n  const deleteConversation = async (sessionId: string, e: React.MouseEvent) => {\n    e.preventDefault();\n    e.stopPropagation();\n\n    if (!confirm('Are you sure you want to delete this conversation?')) {\n      return;\n    }\n\n    try {\n      const response = await fetch(`http://localhost:5000/chat/delete/${sessionId}`, {\n        method: 'DELETE',\n        headers: {\n          'Content-Type': 'application/json',\n        },\n      });\n\n      if (!response.ok) {\n        throw new Error('Failed to delete conversation');\n      }\n\n      setConversations(conversations.filter((c) => c.session_id !== sessionId));\n\n      // If deleting current conversation, redirect to home\n      if (sessionId === currentSessionId) {\n        router.push('/');\n      }\n    } catch (error) {\n      console.error('Failed to delete conversation:', error);\n      alert('Failed to delete conversation');\n    }\n  };\n\n  const handleNewChat = async () => {\n    try {\n      const response = await fetch('http://localhost:5000/chat/new', {\n        method: 'POST',\n      });\n      if (!response.ok) {\n        throw new Error('Failed to create new chat');\n      }\n      const data = await response.json();\n      router.push(`/chat/${data.session_id}`);\n    } catch (error) {\n      console.error('Failed to create new session:', error);\n      alert('Failed to create new chat');\n    }\n  };\n\n  return (\n    <div className=\"w-64 bg-gray-800 text-white flex flex-col border-r border-gray-700 h-screen\">\n      {/* New Chat Button */}\n      <button\n        onClick={handleNewChat}\n        className=\"m-4 flex items-center justify-center gap-2 bg-green-600 hover:bg-green-700 text-white font-semibold py-2 px-4 rounded-lg transition\"\n      >\n        <Plus size={20} />\n        New Chat\n      </button>\n\n      {/* Divider */}\n      <div className=\"px-4\">\n        <div className=\"h-px bg-gray-700\"></div>\n      </div>\n\n      {/* History Section */}\n      <div className=\"flex-1 overflow-y-auto\">\n        <div className=\"px-4 py-3\">\n          <h2 className=\"text-xs uppercase tracking-wider text-gray-400 font-semibold\">\n            Conversation History\n          </h2>\n        </div>\n\n        {loading ? (\n          <div className=\"px-4 py-2 text-sm text-gray-400\">Loading conversations...</div>\n        ) : error ? (\n          <div className=\"px-4 py-2 text-sm text-red-400\">{error}</div>\n        ) : conversations.length === 0 ? (\n          <div className=\"px-4 py-2 text-sm text-gray-400\">No conversations yet</div>\n        ) : (\n          <div className=\"space-y-1 px-2\">\n            {conversations.map((conversation) => (\n              <Link\n                key={conversation.session_id}\n                href={`/chat/${conversation.session_id}`}\n                className={`block p-3 rounded-lg transition group ${\n                  currentSessionId === conversation.session_id\n                    ? 'bg-green-600 text-white'\n                    : 'bg-gray-700 hover:bg-gray-600 text-gray-100'\n                }`}\n              >\n                <div className=\"flex items-start justify-between gap-2\">\n                  <div className=\"flex-1 min-w-0\">\n                    <div className=\"flex items-center gap-2\">\n                      <MessageCircle size={14} className=\"flex-shrink-0 mt-0.5\" />\n                      <p className=\"font-semibold text-sm truncate\">\n                        {conversation.first_message?.substring(0, 25) || 'Untitled'}...\n                      </p>\n                    </div>\n                    <p className=\"text-xs text-gray-400 mt-1\">\n                      {conversation.message_count} messages\n                    </p>\n                    <span className=\"text-xs text-gray-500\">\n                      {new Date(conversation.last_message_time).toLocaleDateString()}\n                    </span>\n                  </div>\n                  <button\n                    onClick={(e) => deleteConversation(conversation.session_id, e)}\n                    className=\"opacity-0 group-hover:opacity-100 transition flex-shrink-0 mt-1\"\n                  >\n                    <Trash2 size={16} className=\"text-red-400 hover:text-red-300\" />\n                  </button>\n                </div>\n              </Link>\n            ))}\n          </div>\n        )}\n      </div>\n\n      {/* Footer */}\n      <div className=\"border-t border-gray-700 p-4\">\n        <button\n          onClick={fetchAllConversations}\n          disabled={loading}\n          className=\"w-full text-xs text-gray-400 hover:text-gray-200 transition disabled:opacity-50\"\n        >\n          Refresh History\n        </button>\n      </div>\n    </div>\n  );\n}"],"names":[],"mappings":"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"}},
    {"offset": {"line": 331, "column": 0}, "map": {"version":3,"sources":["file:///home/yannis/Spotify_Agent/spotify-agent-frontend/src/app/chat/%5BsessionId%5D/page.tsx"],"sourcesContent":["'use client';\n\nimport { useParams } from 'next/navigation';\nimport ChatWindow from '@/components/ChatWindow';\nimport Sidebar from '@/components/Sidebar';\nimport { useState } from 'react';\n\nexport default function ChatPage() {\n  const params = useParams();\n  const sessionId = params.sessionId as string;\n  const [refreshKey, setRefreshKey] = useState(0);\n\n  const handleNewChat = () => {\n    // Redirect to new chat\n    window.location.href = '/';\n  };\n\n  return (\n    <div className=\"flex h-screen bg-gray-900\">\n      <Sidebar currentSessionId={sessionId} onNewChat={handleNewChat} />\n      {sessionId && <ChatWindow key={refreshKey} sessionId={sessionId} />}\n    </div>\n  );\n}"],"names":[],"mappings":";;;;;AAEA;AACA;AACA;AACA;AALA;;;;;;AAOe,SAAS;IACtB,MAAM,SAAS,IAAA,gMAAS;IACxB,MAAM,YAAY,OAAO,SAAS;IAClC,MAAM,CAAC,YAAY,cAAc,GAAG,IAAA,kQAAQ,EAAC;IAE7C,MAAM,gBAAgB;QACpB,uBAAuB;QACvB,OAAO,QAAQ,CAAC,IAAI,GAAG;IACzB;IAEA,qBACE,+RAAC;QAAI,WAAU;;0BACb,+RAAC,yLAAO;gBAAC,kBAAkB;gBAAW,WAAW;;;;;;YAChD,2BAAa,+RAAC,4LAAU;gBAAkB,WAAW;eAAvB;;;;;;;;;;;AAGrC"}}]
}